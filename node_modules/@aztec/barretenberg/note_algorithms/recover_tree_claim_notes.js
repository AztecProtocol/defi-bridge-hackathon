"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.recoverTreeClaimNotes = void 0;
const bigint_buffer_1 = require("../bigint_buffer");
const bridge_id_1 = require("../bridge_id");
const client_proofs_1 = require("../client_proofs");
const tree_claim_note_1 = require("./tree_claim_note");
exports.recoverTreeClaimNotes = (decryptedNotes, proofs) => decryptedNotes.map((decrypted, i) => {
    const proof = proofs[i];
    if (proof.proofId !== client_proofs_1.ProofId.DEFI_DEPOSIT) {
        throw new Error('Proof does not have a claim note.');
    }
    if (!decrypted) {
        return;
    }
    const value = bigint_buffer_1.toBigIntBE(proof.publicOutput);
    const bridgeId = bridge_id_1.BridgeId.fromBuffer(proof.assetId);
    const partialState = Buffer.concat([proof.inputOwner, proof.outputOwner]);
    const defiInteractionNonce = 0;
    return new tree_claim_note_1.TreeClaimNote(value, bridgeId, defiInteractionNonce, BigInt(0), partialState);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjb3Zlcl90cmVlX2NsYWltX25vdGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL25vdGVfYWxnb3JpdGhtcy9yZWNvdmVyX3RyZWVfY2xhaW1fbm90ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsb0RBQThDO0FBQzlDLDRDQUF3QztBQUN4QyxvREFBMkM7QUFHM0MsdURBQWtEO0FBRXJDLFFBQUEscUJBQXFCLEdBQUcsQ0FBQyxjQUE2QyxFQUFFLE1BQXdCLEVBQUUsRUFBRSxDQUMvRyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFO0lBQ2xDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4QixJQUFJLEtBQUssQ0FBQyxPQUFPLEtBQUssdUJBQU8sQ0FBQyxZQUFZLEVBQUU7UUFDMUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO0tBQ3REO0lBRUQsSUFBSSxDQUFDLFNBQVMsRUFBRTtRQUNkLE9BQU87S0FDUjtJQUVELE1BQU0sS0FBSyxHQUFHLDBCQUFVLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzdDLE1BQU0sUUFBUSxHQUFHLG9CQUFRLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwRCxNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUMxRSxNQUFNLG9CQUFvQixHQUFHLENBQUMsQ0FBQztJQUMvQixPQUFPLElBQUksK0JBQWEsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLG9CQUFvQixFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUMzRixDQUFDLENBQUMsQ0FBQyJ9